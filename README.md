# 基于GPT2的中文摘要生成


## 项目描述
- 本项目使用gpt2的模型使用2017年NLPCC的摘要提取数据集进行训练。
- 参考了作者2022中国软件杯A5赛道《智能文本创作》（为学习强国文章命名标题）

## 运行环境
python3.6、 transformers==2.1.1、pytorch==1.9.0

## 项目结构
- config:存放GPT2模型的参数的配置文件
- data:nlpcc2017_clean.json:清洗过的nlpcc语料、train_tokenized.txt:对原始训练语料进行顺序tokenize之后的文件，用于model的训练
- summary_model:存放摘要生成的模型
- vocabulary:存放GPT2模型的字典
- train.py:训练代码
- interact.py:测试代码


## 模型参数(详见config/model_config_dialogue_small.json文件)
- initializer_range: 0.02
- layer_norm_epsilon: 1e-05
- n_ctx: 300
- n_embd: 768
- n_head: 12
- n_layer: 10
- n_positions: 300
- vocab_size: 13317

## Chinese Summary
在训练Chinese Summary时，将上述训练数据进行如下拼接然后，将上述拼接结果作为Summary Model的输入，对模型进行训练
```python
[CLS]"四海网讯，近日，有媒体报道称：章子怡真怀孕了!报道还援引知情人士消息称，“章子怡怀孕大概四五个月，预产期是年底前后，现在已经不接工作了。”这到底是怎么回事?消息是真是假?针对此消息，23日晚8时30分，华西都市报记者迅速联系上了与章子怡家里关系极好的知情人士，这位人士向华西都市报记者证实说：“子怡这次确实怀孕了。她已经36岁了，也该怀孕了。章子怡怀上汪峰的孩子后，子怡的父母亲十分高兴。子怡的母亲，已开始悉心照料女儿了。子怡的预产期大概是今年12月底。”当晚9时，华西都市报记者为了求证章子怡怀孕消息，又电话联系章子怡的亲哥哥章子男，但电话通了，一直没有人<Paragraph>接听。有关章子怡怀孕的新闻自从2013年9月份章子怡和汪峰恋情以来，就被传N遍了!不过，时间跨入2015年，事情却发生着微妙的变化。2015年3月21日，章子怡担任制片人的电影《从天儿降》开机，在开机发布会上几张合影，让网友又燃起了好奇心：“章子怡真的怀孕了吗?”但后据证实，章子怡的“大肚照”只是影片宣传的噱头。过了四个月的7月22日，《太平轮》新一轮宣传，章子怡又被发现状态不佳，不时深呼吸，不自觉想捂住肚子，又觉得不妥。然后在8月的一天，章子怡和朋友吃饭，在酒店门口被风行工作室拍到了，疑似有孕在身!今年7月11日，汪峰本来在上海要举行演唱会，后来因为台风“灿鸿”取消了。而消息人士称，汪峰原来打算在演唱会上当着章子怡的面宣布重大消息，而且章子怡已经赴上海准备参加演唱会了，怎知遇到台风，只好延期，相信9月26日的演唱会应该还会有惊喜大白天下吧。"[SEP]"知情人透露章子怡怀孕后，父母很高兴。章母已开始悉心照料。据悉，预产期大概是12月底"[SEP]
```
## 数据集分享
由于NLPCC2017的下载网址已经失效，建议百度网盘下载
链接：https://pan.baidu.com/s/1k-EbJuD7yaawSQQ83jt_fg?pwd=6666 
提取码：6666
## 模型使用方法
##### 将GPT2-nlpcc-summary参数下载，放入summary_model文件夹中，运行interact.py即可。
## 联系作者
- 邮件我：shulehao@gmail.com
- 微信我：加我*微信号：caojuan021112*, 进Python-NLP交流群，备注：*姓名-公司名-NLP*

<img src="docs/wechat.jpg" width="200" />